program ex4p3
    implicit none
    integer,parameter :: n=10
    real :: a(n,n)
    integer :: i, j

    ! --- For the RNG
    integer :: s
    integer,allocatable :: seed(:)

    ! ---- Start of RNG setup

    ! Set up the seed
    call random_seed(size=s)
    allocate(seed(s))
    seed=1277345
    call random_seed(put=seed)
    ! Fill array a with random numbers
    ! in the interval [0,1[
    call random_number(a)

    ! ---- End of RNG setup

    ! ---- Additions

    write(6, '(a)') '! Before'
    write(*,*)
    do i = 1, n
        write(6, '(a)', advance = 'no') '! '
        write(6, '(40(F7.2))') a(i,:)
    end do
    write(*,*)

    write(6, '(a)') '! After'
    write(*,*)

    where(a < 0.5) a = 0.0
    where(a < 0.75 .and. a /= 0.0) a = 0.75

    do i = 1, n
        write(6, '(a)', advance = 'no') '! '
        write(6, '(40(F7.2))') a(i,:)
    end do

end program ex4p3

! Before

!    0.60   0.06   0.31   0.35   0.89   0.58   0.25   0.02   0.16   0.03
!    0.87   0.40   0.52   0.31   0.52   0.72   0.93   0.31   0.21   0.87
!    0.73   0.13   0.72   0.94   0.77   0.24   0.78   0.06   0.76   0.76
!    0.34   0.51   0.80   0.80   0.02   0.94   0.39   0.93   0.79   0.04
!    0.07   0.15   0.64   0.50   0.58   0.01   0.79   0.94   0.47   0.55
!    0.62   0.01   0.81   0.27   0.52   0.48   0.79   0.52   1.00   0.08
!    0.70   0.48   0.92   0.61   0.48   0.68   0.64   0.22   0.03   0.87
!    0.50   0.64   0.11   0.79   0.98   0.61   0.56   0.40   0.40   0.54
!    0.88   0.87   0.02   0.23   0.34   0.21   0.14   0.09   0.51   0.70
!    0.21   1.00   0.78   0.42   0.80   0.02   0.53   0.01   0.97   0.77

! After

!    0.75   0.00   0.00   0.00   0.89   0.75   0.00   0.00   0.00   0.00
!    0.87   0.00   0.75   0.00   0.75   0.75   0.93   0.00   0.00   0.87
!    0.75   0.00   0.75   0.94   0.77   0.00   0.78   0.00   0.76   0.76
!    0.00   0.75   0.80   0.80   0.00   0.94   0.00   0.93   0.79   0.00
!    0.00   0.00   0.75   0.75   0.75   0.00   0.79   0.94   0.00   0.75
!    0.75   0.00   0.81   0.00   0.75   0.00   0.79   0.75   1.00   0.00
!    0.75   0.00   0.92   0.75   0.00   0.75   0.75   0.00   0.00   0.87
!    0.75   0.75   0.00   0.79   0.98   0.75   0.75   0.00   0.00   0.75
!    0.88   0.87   0.00   0.00   0.00   0.00   0.00   0.00   0.75   0.75
!    0.00   1.00   0.78   0.00   0.80   0.00   0.75   0.00   0.97   0.77

